<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <title>An Introduction to Usync</title>
    <meta name="description" content="Usync is a a site-to-site synchronization tool written in Scsh. It makes use of Unison, and rsync, for bi- and uni-directional synchronizations, respectively.  The sources, along with additional information, are located at github.com/ebzzry/usync....">
    <meta name="author"      content="Rommel Martinez">
    <meta name="keywords"    content="scheme, programming">
    <meta name="viewport"    content="width=device-width, initial-scale=1.0">

    <!-- <link rel="icon"      href="/favicon.ico"> -->

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <link rel="canonical" href="http://ebzzry.github.io/blog/2013/05/21/an-introduction-to-usync/">
    <!-- CSS -->
    <!-- <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css"> -->
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/css/pygments.css">
    <link rel="stylesheet" type="text/css" href="/css/scribble.css">
    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <!-- Feeds -->
    <link ref="alternate" type="application/atom+xml"
          href="/feeds/all.atom.xml" title="Atom Feed">
    <link ref="alternate" type="application/rss+xml"
          href="/feeds/all.rss.xml" title="RSS Feed">
    <!-- JS -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-xxxxx']);
      _gaq.push(['_setDomainName', 'example.com']);
      _gaq.push(['_trackPageview']);
      setTimeout(function(){_gaq.push(['_trackEvent', '30_seconds', 'read'])}, 30000); // http://drawingablank.me/blog/fix-your-bounce-rate.html
      (function() {
          var ga = document.createElement('script');
          ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body id="wrapper">
    <!-- A standard Twitter Bootstrap nav bar -->
    <header class="navbar navbar-default navbar-inverse"
            role="banner">
      <div class="container">
        <div class="navbar-header">
          <button type="button"
                  class="navbar-toggle"
                  data-toggle="collapse"
                  data-target=".our-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!-- <a href="/index.html" class="navbar-brand">Home</a> -->
          <!-- <a href="/index.html">Home</a> -->
        </div>
        <div class="collapse navbar-collapse our-nav-collapse" role="navigation">
          <ul class="nav navbar-nav">

            <li>
              <a href="/index.html">Home</a>
            </li> 
            <li>
              <a href="/about.html">About</a>
            </li> 
            <!-- <li><a href="/feeds/all.atom.xml">Atom</a></li> -->
            <li><a href="/feeds/all.rss.xml">RSS</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Tags <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="/index.html">All Posts</a></li>

<li><a href="/tags/backups.html">backups</a></li>

<li><a href="/tags/compsci.html">compsci</a></li>

<li><a href="/tags/emacs.html">emacs</a></li>

<li><a href="/tags/gpg.html">gpg</a></li>

<li><a href="/tags/mail.html">mail</a></li>

<li><a href="/tags/programming.html">programming</a></li>

<li><a href="/tags/racket.html">racket</a></li>

<li><a href="/tags/rants.html">rants</a></li>

<li><a href="/tags/scheme.html">scheme</a></li>

<li><a href="/tags/ssh.html">ssh</a></li>

<li><a href="/tags/sysadmin.html">sysadmin</a></li>

<li><a href="/tags/web.html">web</a></li>
              </ul>
            </li>
          </ul>
        </div>
    </header>
    <div class="container">
      <div class="row">

        <!-- Main column -->
        <div id="content" class="col-md-12">





          <article>
  <header>
    <h1>An Introduction to Usync</h1>

<p class="date-and-tags">
 <time datetime="2013-05-21" pubdate="true">2013-05-21</time> :: <span class="tags"><a href="/tags/scheme.html">scheme</a>, <a href="/tags/programming.html">programming</a></span></p>
  </header>

<p>Usync is a a site-to-site synchronization tool written in <a href="http://www.scsh.net">Scsh</a>. It makes use of <a href="http://www.cis.upenn.edu/~bcpierce/unison/">Unison</a>, and <a href="http://rsync.samba.org/">rsync</a>, for bi- and uni-directional synchronizations, respectively.</p>

<p>The sources, along with additional information, are located at <a href="http://github.com/ebzzry/usync">github.com/ebzzry/usync</a>.</p>
<!-- more-->

<h1 id="introduction">Introduction</h1>

<p>Site-to-site synchronizations are usually needed, when two locations, which are called sites, in this article, make file updates independently. Let&rsquo;s say the company <strong>Foo</strong> has two offices. In the first office, they have the accounting, and logistics departments. In the second office, they have the IT, and HR departments. Both have a common <code>/pub</code> tree, that has subdirectories assigned to each department. Without synchronization, when the first office needs information from the second office, they&rsquo;d have to pull the updates, manually. With synchronization, the first office can access the files from the second office, as if the IT and HR departments, were in the first office. Usync helps to achieve this.</p>

<h1 id="basic-usage">Basic Usage</h1>

<p>To perform two-way synchronization of the directory <code>/pub/yot/ninam</code>, between the current host, to the hosts <code>tarupam</code>, and <code>taubetmo</code>, while preserving the directory structure remotely (take note, that there must be no spaces between the hosts specification, due to the <code>IFS</code> environment variable, found in most shells):</p>

<div class="brush: console">
 <table class="sourcetable">
  <tbody>
   <tr>
    <td class="linenos">
     <div class="linenodiv">
      <pre>1</pre></div></td>
    <td class="code">
     <div class="source">
      <pre><span class="gp">$</span> usync /pub/yot/ninam/ tarupam,taubetmo
</pre></div>
</td></tr></tbody></table>
</div>

<p>The command above will perform two-way synchronization of the diretory <code>ninam/</code> found under <code>/pub/yot/</code>, to <code>tarupam:/pub/yot/</code>, and <code>taubetmo:/pub/yot/</code>.</p>

<p>Using our example above, the two-way synchronization system basically tells that if the tree <code>tarupam:/pub/yot/ninam/</code> contains new and/or updated items, compared with <code>localhost:/pub/yot/ninam/</code>, and <code>localhost:/pub/yot/ninam/</code> also happens to have new and/or updated items, then, they will trade updates.</p>

<p>Ideally, the result is that <code>localhost:/pub/yot/ninam/</code>, <code>tarupam:/pub/yot/ninam/</code>, and <code>taubetmo:/pub/yot/ninam/</code>, are all equal.</p>

<h1 id="semi-advanced-usage">Semi-advanced Usage</h1>

<p>It is also possible to perform synchronization of multiple files, and directories, to remote hosts. To do so, run:</p>

<div class="brush: console">
 <table class="sourcetable">
  <tbody>
   <tr>
    <td class="linenos">
     <div class="linenodiv">
      <pre>1</pre></div></td>
    <td class="code">
     <div class="source">
      <pre><span class="gp">$</span> usync /pub/yot/ninam/ ~/file.text ~reyn/*.blend tarupam,taubetmo
</pre></div>
</td></tr></tbody></table>
</div>

<p>The command above will perform two-way synchronization of the paths <code>/pub/yot/ninam/</code>, <code>~/file.text</code>, and <code>~reyn/*.blend</code> to the remote hosts <code>tarupam</code>, and <code>taubetmo</code>, using the same directory structuring system described above.</p>

<p>If you want to perform one-way synchronization, of the above, like <code>rsync</code>, run:</p>

<div class="brush: console">
 <table class="sourcetable">
  <tbody>
   <tr>
    <td class="linenos">
     <div class="linenodiv">
      <pre>1</pre></div></td>
    <td class="code">
     <div class="source">
      <pre><span class="gp">$</span> usync --one-way --prefer-local /pub/yot/ninam/ ~/file.text ~reyn/draft.blend tarupam,taubetmo
</pre></div>
</td></tr></tbody></table>
</div>

<p>For more usage information, run:</p>

<div class="brush: console">
 <table class="sourcetable">
  <tbody>
   <tr>
    <td class="linenos">
     <div class="linenodiv">
      <pre>1</pre></div></td>
    <td class="code">
     <div class="source">
      <pre><span class="gp">$</span> usync --help
</pre></div>
</td></tr></tbody></table>
</div>

<h1 id="caveats">Caveats</h1>

<p>This program has been used on FreeBSD, hence making the shebang line contain <code>/usr/local/bin/scsh</code>. Please change it, accordingly.</p>
  <footer>
    <script type="text/javascript">
      !function(d,s,id){
          var js,fjs=d.getElementsByTagName(s)[0];
          if(!d.getElementById(id)){
              js=d.createElement(s);
              js.id=id;
              js.src="//platform.twitter.com/widgets.js";
              fjs.parentNode.insertBefore(js,fjs);
          }
      }(document,"script","twitter-wjs");
    </script>
    <a href="https://twitter.com/share"
       class="twitter-share-button"
       data-url="http://ebzzry.github.io/blog/2013/05/21/an-introduction-to-usync/"
       data-dnt="true">
      "Tweet"</a>
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
    <g:plusone size="medium" href="http://ebzzry.github.io/blog/2013/05/21/an-introduction-to-usync/"></g:plusone>
    <script type="text/javascript">
      var disqus_shortname = 'ebzzrygithubio';
      (function() {
          var dsq = document.createElement('script');
          dsq.type = 'text/javascript';
          dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <div id="disqus_thread"></div>
    <ul class="pager">
    <li class="previous">
      <a href="/blog/2013/05/29/an-introduction-to-livefrog/">&larr; <em>An Introduction to Livefrog</em></a>
    </li>
    <li class="next">
      <a href="/blog/2013/05/09/squandered-relentlessness/"><em>Squandered Relentlessness</em> &rarr;</a>
    </li>
    </ul>
  </footer>
</article>
        </div>
      </div>
      <footer>
        <hr />
        <p><a href="https://twitter.com/ebzzry"
              class="twitter-follow-button"
              data-show-count="false"
              data-lang="en">
             "Follow Rommel"
           </a>
           <script type="text/javascript">
             !function(d,s,id){
                 var js,fjs=d.getElementsByTagName(s)[0];
                 if(!d.getElementById(id)){
                     js=d.createElement(s);
                     js.id=id;
                     js.src="//platform.twitter.com/widgets.js";
                     fjs.parentNode.insertBefore(js,fjs);
                 }
             }(document,"script","twitter-wjs");
           </script></p>
        <p>Site created with
          <a href="http://www.racket-lang.org">Racket</a>,
          <a href="http://github.com/greghendershott/frog">Frog</a>,
          <a href="http://www.gnu.org/software/emacs/">Emacs</a>, and
          <a href="http://twitter.github.io/bootstrap">Bootstrap</a></p>
        <p><em>Copyright &copy; by <a href="http://rmm.meta.ph">Rommel M. Martinez</a></em></p>
      </footer>
    </div>
    <!-- </body> JS -->
    <script type="text/javascript" src="//code.jquery.com/jquery.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  </body>
</html>