<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <title>Emacs and Racket</title>
    <meta name="description" content="In this post, I'll discuss the easiest approach that I took to setup up a Racket development environment on Emacs. Take note, that this is not the only approach available -- some did it in arguably better ways. In this article, I'll try to explain the sho...">
    <meta name="author"      content="Rommel Martinez">
    <meta name="keywords"    content="emacs, programming, racket">
    <meta name="viewport"    content="width=device-width, initial-scale=1.0">
    <link rel="icon"      href="/favicon.ico">
    <link rel="canonical" href="http://www.example.com/blog/2013/09/29/emacs-and-racket/">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/pygments.css">
    <link rel="stylesheet" type="text/css" href="/css/scribble.css">
    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <!-- Feeds -->
    <link ref="alternate" type="application/atom+xml"
          href="/feeds/all.atom.xml" title="Atom Feed">
    <link ref="alternate" type="application/rss+xml"
          href="/feeds/all.rss.xml" title="RSS Feed">
    <!-- JS -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-xxxxx']);
      _gaq.push(['_setDomainName', 'example.com']);
      _gaq.push(['_trackPageview']);
      setTimeout(function(){_gaq.push(['_trackEvent', '30_seconds', 'read'])}, 30000); // http://drawingablank.me/blog/fix-your-bounce-rate.html
      (function() {
          var ga = document.createElement('script');
          ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body id="wrapper">
    <!-- A standard Twitter Bootstrap nav bar -->
    <header class="navbar navbar-default navbar-inverse"
            role="banner">
      <div class="container">
        <div class="navbar-header">
          <button type="button"
                  class="navbar-toggle"
                  data-toggle="collapse"
                  data-target=".our-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!-- <a href="/index.html" class="navbar-brand">Home</a> -->
          <a href="/index.html" class="navbar-brand">Home</a>
        </div>
        <div class="collapse navbar-collapse our-nav-collapse"
             role="navigation">
          <ul class="nav navbar-nav">

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Tags <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="/index.html">All Posts</a></li>

<li><a href="/tags/backups.html">backups</a></li>

<li><a href="/tags/emacs.html">emacs</a></li>

<li><a href="/tags/gpg.html">gpg</a></li>

<li><a href="/tags/mail.html">mail</a></li>

<li><a href="/tags/programming.html">programming</a></li>

<li><a href="/tags/racket.html">racket</a></li>

<li><a href="/tags/rants.html">rants</a></li>

<li><a href="/tags/scheme.html">scheme</a></li>

<li><a href="/tags/ssh.html">ssh</a></li>

<li><a href="/tags/sysadmin.html">sysadmin</a></li>

<li><a href="/tags/web.html">web</a></li>
              </ul>
            </li>
            <li>
              <a href="/About.html">About</a>
            </li> 
            <li><a href="/feeds/all.atom.xml">Atom</a></li>
            <li><a href="/feeds/all.rss.xml">RSS</a></li>
          </ul>
        </div>
    </header>
    <div class="container">
      <div class="row">

        <!-- Main column -->
        <div id="content" class="col-md-12">





          <article>
  <header>
    <h1>Emacs and Racket</h1>

<p class="date-and-tags">
 <time datetime="2013-09-29" pubdate="true">2013-09-29</time> :: <span class="tags"><a href="/tags/emacs.html">emacs</a>, <a href="/tags/programming.html">programming</a>, <a href="/tags/racket.html">racket</a></span></p>
  </header>

<p>In this post, I&rsquo;ll discuss the easiest approach that I took to setup up a <a href="http://racket-lang.org">Racket</a> development environment on Emacs. Take note, that this is not the only approach available &mdash; some did it in arguably better ways. In this article, I&rsquo;ll try to explain the shortest route that I took.</p>
<!-- more-->

<h1 id="introduction">Introduction</h1>

<p>Editing Racket code with Emacs has traditionally been done by rudimentary modes that mostly lacked flexibility. They were able to evaluate current definitions, last definitions, and entire buffers, for the most part. Unfortunately, that didn&rsquo;t suffice with the way Racket dealt with things. A more intelligent way of handling code, was needed.</p>

<p>Fortunately, we have <a href="http://www.nongnu.org/geiser/">Geiser</a>. To quote the first paragraph on its homepage:</p>

<blockquote>
 <p>Geiser is a collection of Emacs major and minor modes that conspire with one or more Scheme interpreters to keep the Lisp Machine Spirit alive. It draws inspiration (and a bit more) from environments such as Common Lisp’s Slime, Factor’s FUEL, Squeak or Emacs itself, and does its best to make Scheme hacking inside Emacs (even more) fun.</p></blockquote>

<p>I saw several other major modes that tries to do what Geiser does, but I became most comfortable with what Geiser offered. Some similar libraries can co-exist with Geiser, too. I tried those, but it became too complex, for me. I wound up just using Geiser. Also, as a semi-related note, I&rsquo;m using Emacs to edit Racket code because I don&rsquo;t know of any other editor that does it so well. I don&rsquo;t use DrRacket, except when I need to use its nice GUI debugger.</p>

<h1 id="installation">Installation</h1>

<p>My installation method is crude, but it works, at least for me. Other installation methods exist, but I couldn&rsquo;t wrap my brain around them, so I opted instead for something that requires the minimal amount of chore. Also, I&rsquo;m still not sure what are the hidden consequences of not doing it the &ldquo;elegant&rdquo; way, presuming there is one.</p>

<p>Let&rsquo;s say that you want to install your Geiser files in <code>~/.emacs.d/elisp/</code>. We&rsquo;ll issue the following commands to install Geiser to that location:</p>

<pre><code>$ mkdir ~/.emacs.d/elisp
$ cd ~/.emacs.d/elisp
$ git clone http://git.sv.gnu.org/r/geiser.git</code></pre>

<p>After that, in <code>~/.emacs.d/elisp/geiser/</code>, you&rsquo;ll have something that looks like the following:</p>

<pre><code>AUTHORS
autogen.sh*
bin/
ChangeLog
configure.ac
COPYING
doc/
elisp/
.git/
.gitignore
INSTALL
Makefile.am
NEWS
README
README.elpa
scheme/
THANKS</code></pre>

<p>Next, we want the directory <code>~/.emacs.d/elisp/geiser/elisp/</code> to be a member of the Emacs variable <code>load-path</code> so that <code>require</code> and friends will know where to find things. To do that, add the following to your Emacs init file &mdash; either in <code>~/.emacs.d/init.el</code>, or in <code>~/.emacs</code> (deprecated):</p>

<pre><code>(add-to-list 'load-path "~/.emacs.d/elisp/geiser/elisp/")</code></pre>

<p>Next, we&rsquo;ll put in the actual code that invokes and configures Geiser:</p>

<pre><code>(require 'geiser)

(setq geiser-active-implementations '(racket))

(defun geiser-save ()
  (interactive)
  (geiser-repl--write-input-ring))</code></pre>

<p>The first expression loads Geiser, itself. The second one specifies that it won&rsquo;t prompt you for other implementations if it finds them. The last one is optional &mdash; it enables you to execute <code>M-x geiser-save</code> in the REPL buffer to force saving of the history to the disk file, which is <code>~/.geiser_history.racket</code>, by default. It is useful if you want to save your REPL session, immediately (Nothing is more horrifying than losing <strong>THAT</strong> expression). For all the Emacs code above, to take effect, you can evaluate them now using members of the eval-* troupe (<code>eval-defun</code>, <code>eval-last-sexp</code>, <code>eval-region</code>), or, you can still opt to respawn a new Emacs process.</p>

<h1 id="usage">Usage</h1>

<p>To reap what you sowed, create or open a <code>.rkt</code> file, with at least a proper module declaration. Then hit:</p>

<pre><code>M-x run-geiser</code></pre>

<p>And, boomshakalaka! A new (Emacs) window opens, containing the <code>* Racket
REPL *</code> buffer. Whatever you can do with the REPL invoked with vanilla command-line <code>racket</code>, you can also do with this, and more. This major mode is actually Comint mode, under the hood, with hooks to a a Racket process. For those of you who are unfamiliar with Comint mode, it is the same mode that handles <code>M-x shell</code>.</p>

<p>So, what can we do with it? While editing <code>.rkt</code> file, here are some of the usual shortcuts that I use (The full list of keys are <a href="http://www.nongnu.org/geiser/geiser_5.html#Cheat-sheet">available here</a>). Take note, that the description of the keys that I used below, are for myself initially, to help me understand what they do. They may, or may not diverge from the official description, listed on the aforementioned link.</p>

<h2 id="racket-buffer">Racket Buffer</h2>

<table>
 <tr>
  <th>Key</th>
  <th>What it does</th></tr>
 <tr>
  <td>C-c C-z</td>
  <td>Switch to the REPL buffer</td></tr>
 <tr>
  <td>C-c C-a</td>
  <td>Evaluate current buffer, then switch to the REPL buffer</td></tr>
 <tr>
  <td>C-M-x</td>
  <td>Evaluate current expression</td></tr>
 <tr>
  <td>C-x C-e</td>
  <td>Evaluate last expression</td></tr>
 <tr>
  <td>C-c C-r</td>
  <td>Evaluate region</td></tr>
 <tr>
  <td>C-c C-\</td>
  <td>Insert a λ symbol</td></tr></table>

<h2 id="repl-buffer">REPL Buffer</h2>

<table>
 <tr>
  <th>Key</th>
  <th>What it does</th></tr>
 <tr>
  <td>C-c C-z</td>
  <td>Switch to the Racket buffer</td></tr>
 <tr>
  <td>M-p</td>
  <td>Switch to the previous history item</td></tr>
 <tr>
  <td>M-n</td>
  <td>Switch to the next history item</td></tr>
 <tr>
  <td>C-c M-p</td>
  <td>Jump to previous prompt</td></tr>
 <tr>
  <td>C-c M-n</td>
  <td>Jump to next prompt</td></tr>
 <tr>
  <td>C-c C-q</td>
  <td>Quit the REPL buffer</td></tr></table>

<h1 id="conclusion">Conclusion</h1>

<p>I have intentionally skipped many topics from the <a href="http://www.nongnu.org/geiser/">official document</a> because it makes it unattractive to people who are averse to reading long blocks of text (ironically, this article may even qualify as one.). The methods described above are by in no way representative of community-advised ways of installing and using Racket with Emacs. Feel free to drop a comment below! Ciao!</p>
  <footer>
    <script type="text/javascript">
      !function(d,s,id){
          var js,fjs=d.getElementsByTagName(s)[0];
          if(!d.getElementById(id)){
              js=d.createElement(s);
              js.id=id;
              js.src="//platform.twitter.com/widgets.js";
              fjs.parentNode.insertBefore(js,fjs);
          }
      }(document,"script","twitter-wjs");
    </script>
    <a href="https://twitter.com/share"
       class="twitter-share-button"
       data-url="http://www.example.com/blog/2013/09/29/emacs-and-racket/"
       data-dnt="true">
      "Tweet"</a>
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
    <g:plusone size="medium" href="http://www.example.com/blog/2013/09/29/emacs-and-racket/"></g:plusone>
    <script type="text/javascript">
      var disqus_shortname = 'ebzzry';
      (function() {
          var dsq = document.createElement('script');
          dsq.type = 'text/javascript';
          dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <div id="disqus_thread"></div>
    <ul class="pager">
    <li class="previous">
      <a href="/blog/2014/02/17/emacs-and-mail/">&larr; <em>Emacs and Mail</em></a>
    </li>
    <li class="next">
      <a href="/blog/2013/09/26/emacs-and-dired/"><em>Emacs and Dired</em> &rarr;</a>
    </li>
    </ul>
  </footer>
</article>
        </div>
      </div>
      <footer>
        <hr />
        <p><a href="https://twitter.com/ebzzry"
              class="twitter-follow-button"
              data-show-count="false"
              data-lang="en">
             "Follow Rommel"
           </a>
           <script type="text/javascript">
             !function(d,s,id){
                 var js,fjs=d.getElementsByTagName(s)[0];
                 if(!d.getElementById(id)){
                     js=d.createElement(s);
                     js.id=id;
                     js.src="//platform.twitter.com/widgets.js";
                     fjs.parentNode.insertBefore(js,fjs);
                 }
             }(document,"script","twitter-wjs");
           </script></p>
        <p>Site created with
          <a href="http://www.racket-lang.org">Racket</a>,
          <a href="http://github.com/greghendershott/frog">Frog</a>,
          <a href="http://www.gnu.org/software/emacs/">Emacs</a>, and
          <a href="http://twitter.github.io/bootstrap">Bootstrap</a></p>
        <p><em>Copyright &copy; by <a href="http://rmm.meta.ph">Rommel M. Martinez</a></em></p>
      </footer>
    </div>
    <!-- </body> JS -->
    <script type="text/javascript" src="//code.jquery.com/jquery.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  </body>
</html>