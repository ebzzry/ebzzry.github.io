<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <title>Emacs Tips 0x03</title>
    <meta name="description" content="In this post, I'll discuss the easiest approach that I have on setting up a
Racket development environment on
Emacs. Take note, that this is not the only approach available -- some did it
in better ways, arguably. In this article, I'll try to explain the shortest
route that I took. ...">
    <meta name="author"      content="Rommel Martinez">
    <meta name="keywords"    content="emacs, programming, racket">
    <meta name="viewport"    content="width=device-width, initial-scale=1.0">
    <link rel="icon"      href="/favicon.ico">
    <link rel="canonical" href="http://www.example.com/blog/2013/09/29/emacs-tips-0x03/">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/pygments.css">
    <link rel="stylesheet" type="text/css" href="/css/scribble.css">
    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <!-- Feeds -->
    <link ref="alternate" type="application/atom+xml"
          href="/feeds/all.atom.xml" title="Atom Feed">
    <link ref="alternate" type="application/rss+xml"
          href="/feeds/all.rss.xml" title="RSS Feed">
    <!-- JS -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-xxxxx']);
      _gaq.push(['_setDomainName', 'example.com']);
      _gaq.push(['_trackPageview']);
      setTimeout(function(){_gaq.push(['_trackEvent', '30_seconds', 'read'])}, 30000); // http://drawingablank.me/blog/fix-your-bounce-rate.html
      (function() {
          var ga = document.createElement('script');
          ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>
    <!-- A standard Twitter Bootstrap nav bar -->
    <header class="navbar navbar-default navbar-inverse"
            role="banner">
      <div class="container">
        <div class="navbar-header">
          <button type="button"
                  class="navbar-toggle"
                  data-toggle="collapse"
                  data-target=".our-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!-- <a href="/index.html" class="navbar-brand">Home</a> -->
          <a href="/index.html" class="navbar-brand">#</a>
        </div>
        <div class="collapse navbar-collapse our-nav-collapse"
             role="navigation">
          <ul class="nav navbar-nav">

            <li>
              <a href="/About.html">About</a>
            </li> 
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Tags <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="/index.html">All Posts</a></li>

<li><a href="/tags/emacs.html">emacs</a></li>

<li><a href="/tags/programming.html">programming</a></li>

<li><a href="/tags/racket.html">racket</a></li>

<li><a href="/tags/rants.html">rants</a></li>

<li><a href="/tags/scheme.html">scheme</a></li>
              </ul>
            </li>
            <li><a href="/feeds/all.atom.xml">Atom</a></li>
            <li><a href="/feeds/all.rss.xml">RSS</a></li>
          </ul>
        </div>
    </header>
    <div class="container">
      <div class="row">

        <!-- Main column -->
        <div id="content" class="col-md-12">






<article>

 <header>

  <h1>Emacs Tips 0x03</h1>

  <p class="date-and-tags">
   <time datetime="2013-09-29" pubdate="true">2013-09-29</time> :: <a href="/tags/emacs.html">emacs</a>, <a href="/tags/programming.html">programming</a>, <a href="/tags/racket.html">racket</a></p>
  </header>


 <p>In this post, I&rsquo;ll discuss the easiest approach that I have on setting up a
<a href="http://racket-lang.org">Racket</a> development environment on
Emacs. Take note, that this is not the only approach available &ndash; some did it
in better ways, arguably. In this article, I&rsquo;ll try to explain the shortest
route that I took.</p>


 <h1>1

  <tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h1>


 <p>Editing Racket code with Emacs has traditionally been done by rudimentary modes
that mostly lacked flexibility. They were able to evaluate current definitions,
last definitions, and entire buffers, for the most part. Unfortunately, that
didn&rsquo;t suffice with the way Racket dealt with things. A more intelligent way of
handling code, was needed.</p>


 <p>Fortunately, we have <a href="http://www.nongnu.org/geiser/">Geiser</a>. To
quote the first paragraph on that link, it says: <span style="font-style: italic">Geiser is a collection of
Emacs major and minor modes that conspire with one or more Scheme interpreters
to keep the Lisp Machine Spirit alive. It draws inspiration (and a bit more)
from environments such as Common Lisp&#8217;s Slime, Factor&#8217;s FUEL, Squeak or Emacs
itself, and does its best to make Scheme hacking inside Emacs (even more)
fun.</span>.</p>


 <p>I saw several other major modes that tries to do what Geiser does, but I became
most comfortable with what Geiser offered. Some similar libraries can co-exist
with Geiser, too. I tried those, but it became too complex, for me. I wound up
just using Geiser. Also, as a semi-related note, I&rsquo;m using Emacs to edit Racket
code because I don&rsquo;t know of any other editor that does it so well. I don&rsquo;t use
DrRacket, except when I need to use its nice GUI debugger. </p>


 <h1>2

  <tt>&nbsp;</tt><a name="(part._.Installation)"></a>Installation</h1>


 <p>My installation method is crude, but it works, at least for me. Other
installation methods exist, but I couldn&rsquo;t wrap my brain around them, so I
opted instead for something that requires the minimal amount of chore. Also,
I&rsquo;m still not sure what are the hidden consequences of not doing it the
"elegant" way, presuming there is one.</p>


 <p>Let&rsquo;s say that you want to install your Geiser files in
<span class="RktSym">~/.emacs.d/elisp/</span><span class="RktMeta"></span>. We&rsquo;ll issue the following commands to install Geiser
to that location:</p>


 <div class="SCodeFlow">

  <table cellspacing="0" class="RktBlk">

   <tbody>

    <tr>

     <td><span class="RktSym">mkdir</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">~/.emacs.d/elisp</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">cd</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">~/.emacs.d/elisp</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">git</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">clone</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">http://git.sv.gnu.org/r/geiser.git</span><span class="RktMeta"></span></td></tr></tbody></table></div>


 <p>After that, in <span class="RktSym">~/.emacs.d/elisp/geiser/</span><span class="RktMeta"></span>, you&rsquo;ll have something that
looks like the following:</p>


 <div class="SCodeFlow">

  <table cellspacing="0" class="RktBlk">

   <tbody>

    <tr>

     <td><span class="RktSym">AUTHORS</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">autogen.sh*</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">bin/</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">ChangeLog</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">configure.ac</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">COPYING</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">doc/</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">elisp/</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">.git/</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">.gitignore</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">INSTALL</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">Makefile.am</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">NEWS</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">README</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">README.elpa</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">scheme/</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktSym">THANKS</span><span class="RktMeta"></span></td></tr></tbody></table></div>


 <p>Next, we want the directory <span class="RktSym">~/.emacs.d/elisp/geiser/elisp/</span><span class="RktMeta"></span> to be a
member of the Emacs variable <span class="RktSym">load-path</span><span class="RktMeta"></span> so that <span class="RktSym">require</span><span class="RktMeta"></span> and
friends will know where to find things. To do that, add the following to your
Emacs init file &ndash; either in <span class="RktSym">~/.emacs.d/init.el</span><span class="RktMeta"></span>, or in <span class="RktSym">~/.emacs</span><span class="RktMeta"></span>
(deprecated):</p>


 <div class="SCodeFlow">

  <table cellspacing="0" class="RktBlk">

   <tbody>

    <tr>

     <td><span class="RktPn">(</span><span class="RktSym">add-to-list</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">'</span><span class="RktSym">load-path</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"~/.emacs.d/elisp/geiser/elisp/"</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></tbody></table></div>


 <p>Next, we&rsquo;ll put in the actual code that invokes and configures Geiser:</p>


 <div class="SCodeFlow">

  <table cellspacing="0" class="RktBlk">

   <tbody>

    <tr>

     <td><span class="RktPn">(</span><span class="RktSym">require</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">'</span><span class="RktSym">geiser</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta">&#160;</span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setq</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">geiser-active-implementations</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">'</span><span class="RktPn">(</span><span class="RktSym">racket</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta">&#160;</span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">defun</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">geiser-save</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">interactive</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr>

    <tr>

     <td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">geiser-repl--write-input-ring</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></tbody></table></div>


 <p>The first expression loads Geiser, itself. The second one specifies that it
won&rsquo;t prompt you for other implementations if it finds them. The last one is
optional &ndash; it enables you to execute <span class="RktSym">M-x</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">geiser-save</span><span class="RktMeta"></span> in the REPL buffer
to force saving of the history to the disk file, which is
<span class="RktSym">~/.geiser_history.racket</span><span class="RktMeta"></span>, by default. The last one is useful if you want
to save your REPL session, immediately (Nothing is more horrifying than losing
<span style="font-style: italic">THAT</span> expression). For all the Emacs code above, to take effect, you can
evaluate them now using members of the <span class="RktSym">eval-*</span><span class="RktMeta"></span> troupe, or, you can still
opt to respawn a new Emacs process.</p>


 <h1>3

  <tt>&nbsp;</tt><a name="(part._.Usage)"></a>Usage</h1>


 <p>To reap what you sowed, create or open a <span class="RktSym">.rkt</span><span class="RktMeta"></span> file, with at least a
proper module declaration. Then hit:</p>


 <div class="SCodeFlow">

  <table cellspacing="0" class="RktBlk">

   <tbody>

    <tr>

     <td><span class="RktSym">M-x</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">run-geiser</span><span class="RktMeta"></span></td></tr></tbody></table></div>


 <p>Aaand, boomshakala! A new (Emacs) window opens, containing the <span class="RktSym">*</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">Racket</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">REPL</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">*</span><span class="RktMeta"></span> buffer. Whatever you can do with the REPL invoked with <span class="RktSym">racket</span><span class="RktMeta"></span>,
you can also do with this, and more. This major mode is actually Comint mode,
under the hood, with hooks to a a Racket process. For those of you who are
unfamiliar with Comint mode, it is the same mode that handles <span class="RktSym">M-x</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">shell</span><span class="RktMeta"></span>.</p>


 <p>So, what can we do with it? While editing <span class="RktSym">.rkt</span><span class="RktMeta"></span> file, here are some of
the usual shortcuts that I use (The full list of keys are available
<a href="http://www.nongnu.org/geiser/geiser_5.html#Cheat-sheet">here</a>). Take note that the description of the keys that I use below, are to
myself, to help me understand what they do. They may, or may not diverge from
the official description, listed on the aforementioned link.</p>


 <p><span style="font-weight: bold">Racket buffer</span></p>


 <p></p>


 <table cellspacing="0" class="boxed">

  <tbody>

   <tr>

    <td>

     <p><span style="font-weight: bold">Key</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p><span style="font-weight: bold">What it does</span></p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-c C-z</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Switch to the REPL</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-c C-a</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Evaluate buffer, then switch to the REPL</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-M-x</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Evaluate current expression</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-x C-e</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Evaluate last expression</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-c C-r</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Evaluate region</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-c C-x</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Insert a &#955; symbol</p></td></tr></tbody></table>


 <p><span style="font-weight: bold">REPL</span></p>


 <p></p>


 <table cellspacing="0" class="boxed">

  <tbody>

   <tr>

    <td>

     <p><span style="font-weight: bold">Key</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p><span style="font-weight: bold">What it does</span></p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-c C-z</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Switch to the Racket buffer</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">M-p</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Switch to previous history item</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">M-n</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Switch to next history item</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-c M-p</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Jump to previous prompt</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-c M-p</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Jump to next prompt</p></td></tr>

   <tr>

    <td>

     <p><span style="font-weight: bold">C-c C-q</span></p></td>

    <td>

     <p><span class="hspace">&nbsp;</span></p></td>

    <td>

     <p>Quit the REPL</p></td></tr></tbody></table>


 <h1>4

  <tt>&nbsp;</tt><a name="(part._.Conclusion)"></a>Conclusion</h1>


 <p>I have intentionally skipped many topics from the
<a href="http://www.nongnu.org/geiser/">official manual</a> because it makes
it unattractive to people who are averse to reading long blocks of text
(ironically, this article may even qualify as one.). The methods described
above are by in no way representative of community-advised ways of installing
and using Racket with Emacs. Feel free to drop a comment below!  Ciao!</p>

 <footer>

  <script type="text/javascript">
      !function(d,s,id){
          var js,fjs=d.getElementsByTagName(s)[0];
          if(!d.getElementById(id)){
              js=d.createElement(s);
              js.id=id;
              js.src="//platform.twitter.com/widgets.js";
              fjs.parentNode.insertBefore(js,fjs);
          }
      }(document,"script","twitter-wjs");
    </script>
    <a class="twitter-share-button" data-dnt="true" data-url="http://www.example.com/blog/2013/09/29/emacs-tips-0x03/" href="https://twitter.com/share">
      "Tweet"</a>

  <script src="https://apis.google.com/js/plusone.js" type="text/javascript"></script>

  <g:plusone href="http://www.example.com/blog/2013/09/29/emacs-tips-0x03/" size="medium"></g:plusone>

  <script type="text/javascript">
      var disqus_shortname = 'ebzzry';
      (function() {
          var dsq = document.createElement('script');
          dsq.type = 'text/javascript';
          dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>

  <div id="disqus_thread"></div>

  <ul class="pager">


   <li class="next">
      <a href="/blog/2013/09/26/emacs-tips-0x02/"><em>Emacs Tips 0x02</em> &rarr;</a>
    </li>
    </ul>
  </footer>
</article>
        </div>
      </div>
      <footer>
        <hr />
        <p><a href="https://twitter.com/ebzzry"
              class="twitter-follow-button"
              data-show-count="false"
              data-lang="en">
             "Follow Rommel"
           </a>
           <script type="text/javascript">
             !function(d,s,id){
                 var js,fjs=d.getElementsByTagName(s)[0];
                 if(!d.getElementById(id)){
                     js=d.createElement(s);
                     js.id=id;
                     js.src="//platform.twitter.com/widgets.js";
                     fjs.parentNode.insertBefore(js,fjs);
                 }
             }(document,"script","twitter-wjs");
           </script></p>
        <p>Site created with
          <a href="http://www.racket-lang.org">Racket</a>,
          <a href="http://github.com/greghendershott/frog">Frog</a>,
          <a href="http://www.gnu.org/software/emacs/">Emacs</a>, and
          <a href="http://twitter.github.io/bootstrap">Bootstrap</a></p>
        <p><em>Copyright &copy; 2013 by <a href="http://rmm.meta.ph">Rommel M. Martinez</a></em></p>
      </footer>
    </div>
    <!-- </body> JS -->
    <script type="text/javascript" src="//code.jquery.com/jquery.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  </body>
</html>