<!DOCTYPE html>
<html><head><title>Conkeror’s Bookmarks</title><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport" /><link href="static/ico/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180" /><link href="static/ico/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" /><link href="static/ico/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" /><link href="static/ico/manifest.json" rel="manifest" /><link color="#5bbad5" href="static/ico/safari-pinned-tab.svg" rel="mask-icon" /><meta content="#ffffff" name="theme-color" /><link href="static/css/main.css" media="all" rel="stylesheet" /><link href="static/css/ewan.css" media="all" rel="stylesheet" /><script async="" src="static/js/highlight.pack.js"></script><script async="">hljs.initHighlightingOnLoad();</script></head><body><div id="content"><h1>Conkeror’s Bookmarks</h1><p><center>August 16, 2015</center> <center>Updated: May 13, 2016</center></p><p>I wanted a simple, and easy way to view my bookmarks in <a href='http://conkeror.org'>Conkeror</a>. However, the proposed solutions on the wiki are not suitable for me. So, I rolled my own.</p><h2>Table of contents</h2><ul><li><a href='#prereq'>Prerequisites</a></li><li><a href='#extract'>Extract the data</a></li><li><a href='#generate'>Generate the bookmarks</a></li><li><a href='#cli'>Create a command-line viewer</a></li><li><a href='#commands'>Define conkeror commands</a></li><li><a href='#alternatives'>Alternatives</a></li><li><a href='#managing'>Managing the bookmarks</a></li><li><a href='#closing'>Closing remarks</a></li></ul><h2>Prerequisites <a name="prereq"></a></h2><p>One of the most important tool that you need to have is the <i>sqlite3</i> command. Chances are, your system provides a way to install it. To check if you have it, or to verify the installation, run:</p><pre><code class="bash">$ sqlite3 --version
</code></pre><p>If it displays a version string, with a build date and hash, then you’re set.</p><p>You also need to have a Java Runtime Environment (JRE) installed. To determine if you have it, run:</p><pre><code class="bash">$ java -version
</code></pre><p>If it reports a version number and other details, then you have Java installed. Otherwise, consult your distro’s package system on how to install it.</p><p>Lastly, you need to have <i>emem</i> properly installed. Follow the instructions at <a href="https://github.com/ebzzry/emem">https://github.com/ebzzry/emem</a>. To verify that you have installed it properly, run:</p><pre><code class="bash">$ emem --version
</code></pre><p>If it reports at least <strong>emem-0.2.1</strong>, then you’re good to go.</p><h2>Extract the data <a name="extract"></a></h2><p>You need to have a way first to extract the data from a sqlite3 database, which Conkeror uses to store the bookmarks, among other things.</p><p>Open your <code>&#126;/.bashrc</code>, or whatever init file your shell uses, then append the following text. Replace <strong>profile.default</strong> with the correct profile name:</p><pre><code class="bash">cob &#40;&#41; {
  sqlite3 -separator ' &lt;&gt; ' \
  $HOME/.conkeror.mozdev.org/conkeror/profile.default/places.sqlite \
  'SELECT p.title, p.url FROM moz&#95;bookmarks b INNER JOIN moz&#95;places p \
  ON b.fk = p.id ORDER BY b.id DESC;' | uniq | perl -pe 's/\&#91;//;s/\&#93;//'
}
</code></pre><p>The command above selects the <strong>title</strong> and <strong>url</strong> columns from the <strong>moz_bookmarks</strong> table, then sorts them by creation date.</p><h2>Generate the bookmarks <a name="generate"></a></h2><p>Next, you need to have a way to generate the HTML file that you’re going to view later in Conkeror. Add the following to your <code>&#126;/.bashrc</code>.</p><pre><code class="bash">bmg &#40;&#41; {
  local base=$HOME/bookmarks
  local file=$base/bookmarks.html
  trap &quot;rm -f ${file}.tmp&quot; HUP INT TERM ABRT

  &#91;&#91; ! -d $base &#93;&#93; &amp;&amp; mkdir -p `dirname $file`

  cob | perl -pe 's/&#94;&#40;.&#42;?&#41;\ \&lt;\&gt;\ &#40;.&#42;&#41;/&#42; &#91;\1&#93;&#40;\2&#41;/' \
      | emem -t Bookmarks -o ${file}.tmp

  &#91;&#91; -f ${file}.tmp &#93;&#93; &amp;&amp; mv -f ${file}.tmp $file
}
</code></pre><p>What it does is that it filters the output of <strong>cob</strong>, which <i>emem</i> then uses to generate the HTML file.</p><h2>Create a command-line viewer <a name="cli"></a></h2><p>Now that you can build the HTML file, you need to have a command that will load the bookmarks in Conkeror. Add the following to your <code>&#126;/.bashrc</code>.</p><pre><code class="bash">bm &#40;&#41; {
  conkeror $HOME/bookmarks/bookmarks.html
}
</code></pre><h2>Define conkeror commands <a name="commands"></a></h2><p>Let’s now create interactive commands for Conkeror, for generating and viewing the bookmarks. Open your <code>&#126;/.conkerorrc</code> file, then put the following:</p><pre><code class="javascript">interactive&#40;
    &quot;b&quot;,
    &quot;Generate the bookmarks file.&quot;,
    function &#40;I&#41; {
        var cwd = I.local.cwd;
        yield shell&#95;command&#40;&quot;bmg&quot;, $cwd = cwd&#41;;
    }&#41;;

interactive&#40;
    &quot;bm&quot;,
    &quot;Open the bookmarks in a new buffer.&quot;,
    function &#40;I&#41; {
        var cwd = I.local.cwd;
        yield shell&#95;command&#40;&quot;bm&quot;, $cwd = cwd&#41;;
    }&#41;;
</code></pre><p>Re-read your rc:</p><pre><code>M-x reinit RET
</code></pre><p>Finally, generate the bookmarks then view it:</p><pre><code>M-x b RET
</code></pre><pre><code>M-x bm RET
</code></pre><h2>Alternatives <a name="alternatives"></a></h2><p>I separated the procedure of generating the bookmarks, from viewing it, because I want to be able to view the bookmarks file quickly, without waiting for the bookmarks to be generated.</p><p>You may, however, want to combine the building and viewing of the bookmarks into one. If that is you want, put the following in your rc:</p><pre><code>interactive&#40;
    &quot;bm&quot;,
    &quot;Generate the bookmarks file, and open it in a new buffer.&quot;,
    function &#40;I&#41; {
        var cwd = I.local.cwd;
        yield shell&#95;command&#40;&quot;bmg; bm&quot;, $cwd = cwd&#41;;
    }&#41;;
</code></pre><p>Invoke it with:</p><pre><code>M-x bm RET
</code></pre><h2>Managing the boomarks <a name="managing"></a></h2><p>An easy way to manage the bookmarks is to use the <a href='https://github.com/lazierthanthou/sqlite-manager'>SQLite Manager</a> extension. This extensions lets you manage SQLite database inside the browser. By default it lets you open the <strong>.sqlite</strong> files in your profile directory.</p><p>To install it, download the .xpi file from <a href="https://github.com/lazierthanthou/sqlite-manager/releases">https://github.com/lazierthanthou/sqlite-manager/releases</a>, then follow the installation instructions at <a href="http://conkeror.org/Extensions">http://conkeror.org/Extensions</a>.</p><p>Next, open your <code>&#126;/.conkerorrc</code>, then add the following:</p><pre><code>interactive&#40;
    &quot;sqlite&quot;, &quot;Open the SQLite Manager&quot;,
    function &#40;I&#41; {
        load&#95;url&#95;in&#95;new&#95;buffer&#40;&quot;chrome://sqlitemanager/content/sqlitemanager.xul&quot;&#41;;
    }&#41;;
</code></pre><p>Then, re-load your settings:</p><pre><code>M-x reinit
</code></pre><p>To run <i>SQLite Manager</i>, hit:</p><pre><code>M-x sqlite
</code></pre><p>In the drop-down box that says <strong>(Select Profile Database)</strong>, select <strong>places.sqlite</strong>, then hit <strong>Go</strong>.</p><p>Do not, however, make modifications to any of the SQLite files in your profile, while Conkeror is running. Doing so may make your browser unable to start, after you exit it, unless you restore from “clean” SQLite files, while Conkeror is not running.</p><h2>Closing remarks <a name="closing"></a></h2><p>The bookmarks displayed in <code>M-x bm</code>, will be sorted by time of creation, in a descending order. The bookmarks listed are also not categorized by “folders”, in the manner of the Firefox’s Bookmarks Manager.</p><p>Another, you may also edit the <code>places.sqlite</code> file with <a href='https://www.sqlite.org/cli.html'>sqlite3</a>, or <a href='https://github.com/sqlitebrowser/sqlitebrowser'>sqlitebrowser</a>.</p><hr/><div style="text-align: right; float: right; max-width: 18em;"><div style="font-size: small;"><a href='index.html'>Home</a>  <a href='about.html'>About</a>  <a href='quotes.html'>Quotes</a>  <a href='words.html'>Words</a>  <a href='https://github.com/ebzzry/ebzzry.github.io'>Source</a></div><div style="font-size: x-small">Site created with <a href='https://github.com/ebzzry/emem'>emem</a></div><p><div style="font-size: x-small"> <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="images/cc4-88x31.png" /></a><br> This work by <a xmlns:cc="http://creativecommons.org/ns#" href="https://ebzzry.github.io" property="cc:attributionName" rel="cc:attributionURL">Rommel M. Martinez</a> is licensed under a<br> <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Common Attribution 4.0 International License</a>. </div></p><p></div></p></div></body></html>