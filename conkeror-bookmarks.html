<html><head><title>Conkeror's Bookmarks</title><meta content="text/html;charset=utf-8" http-equiv="Content-Type" /><link href="static/ico/glider.ico" rel="icon" type="image/x-icon" /><link href="static/css/main.css" media="all" rel="stylesheet" /><link href="static/css/ewan.css" media="all" rel="stylesheet" /><script src="static/js/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><h1>Conkeror's Bookmarks</h1><p><center>2015-08-16 01:14:09</center></p><p>I wanted a simple, and easy way to view my bookmarks in <a href='http://conkeror.org'>Conkeror</a>. However, the proposed solutions on the wiki are not suitable for me. So, I rolled my own.</p><h2>Prerequisites</h2><p>One of the most important tool that you need to have is the <i>sqlite3</i> command. Chances are, your system provides a way to install it. To check if you have it, or to verify the installation, run:</p><pre><code class="bash">$ sqlite3 --version
</code></pre><p>If it displays a version string, with a build date and hash, then you're set.</p><p>You also need to have a Java Runtime Environment (JRE) installed. To determine if you have it, run:</p><pre><code class="bash">$ java -version
</code></pre><p>If it reports a version number and other details, then you have Java installed. Otherwise, consult your distro's package system on how to install it.</p><p>Lastly, you need to have <i>emem</i> properly installed. Follow the instructions at <a href="https://github.com/ebzzry/emem">https://github.com/ebzzry/emem</a>. To verify that you have installed it properly, run:</p><pre><code class="bash">$ emem --version
</code></pre><p>If it reports at least <code>emem-0.2.1</code>, then you're good to go.</p><h2>Extract the Data</h2><p>You need to have a way first to extract the data from a sqlite3 database, which Conkeror uses to store the bookmarks, among other things.</p><p>Open your <code>&#126;/.bashrc</code>, or whatever init file your shell uses, then append the following text. Replace <code>profile.default</code> with the correct profile name:</p><pre><code class="bash">cob &#40;&#41; {
  sqlite3 -separator ' &lt;&gt; ' \
  $HOME/.conkeror.mozdev.org/conkeror/profile.default/places.sqlite \
  'SELECT p.title, p.url FROM moz&#95;bookmarks b INNER JOIN moz&#95;places p \
  ON b.fk = p.id ORDER BY b.id DESC;' | uniq
}
</code></pre><p>The command above selects the <code>title</code> and <code>url</code> columns from the <code>moz&#95;bookmarks</code> table, then sorts them by creation date.</p><h2>Generate the Bookmarks</h2><p>Next, you need to have a way to generate the HTML file that you're going to view later in Conkeror. Add the following to your <code>&#126;/.bashrc</code>.</p><pre><code class="bash">bmg &#40;&#41; {
  local base=$HOME/bookmarks
  local file=$base/bookmarks.html
  trap &quot;rm -f ${file}.tmp&quot; HUP INT TERM ABRT

  &#91;&#91; ! -d $base &#93;&#93; &amp;&amp; mkdir -p `dirname $file`

  cob | perl -pe 's/&#94;&#40;.&#42;?&#41;\ \&lt;\&gt;\ &#40;.&#42;&#41;/&#42; &#91;\1&#93;&#40;\2&#41;/' \
      | emem -t Bookmarks -o ${file}.tmp

  &#91;&#91; -f ${file}.tmp &#93;&#93; &amp;&amp; mv -f ${file}.tmp $file
}
</code></pre><p>What it does is that it filters the output of <code>cob</code>, which <i>emem</i> then uses to generate the HTML file.</p><h2>Create a CLI Viewer</h2><p>Now that you can build the HTML file, you need to have a command that will load the bookmarks in Conkeror. Add the following to your <code>&#126;/.bashrc</code>.</p><pre><code class="bash">bm &#40;&#41; {
  conkeror $HOME/bookmarks/bookmarks.html
}
</code></pre><h2>Conkeror Commands</h2><p>Let's now create interactive commands for Conkeror, for generating and viewing the bookmarks. Open your <code>&#126;/.conkerorrc</code> file, then put the following:</p><pre><code class="javascript">interactive&#40;
    &quot;bmg&quot;,
    &quot;Generate the bookmarks file.&quot;,
    function &#40;I&#41; {
        var cwd = I.local.cwd;
        yield shell&#95;command&#40;&quot;bmg&quot;, $cwd = cwd&#41;;
    }&#41;;

interactive&#40;
    &quot;bm&quot;,
    &quot;Open the bookmarks in a new buffer.&quot;,
    function &#40;I&#41; {
        var cwd = I.local.cwd;
        yield shell&#95;command&#40;&quot;bm&quot;, $cwd = cwd&#41;;
    }&#41;;
</code></pre><p>Re-read your rc:</p><pre><code>M-x reinit RET
</code></pre><p>Finally, generate the bookmarks then view it:</p><pre><code>M-x bmg RET
</code></pre><pre><code>M-x bm RET
</code></pre><h2>Alternatives</h2><p>I separated the procedure of generating the bookmarks, from viewing it, because I want to be able to view the bookmarks file quickly, without waiting for the bookmarks to be generated.</p><p>You may, however, want to combine the building and viewing of the bookmarks into one. If that is you want, put the following in your rc:</p><pre><code>interactive&#40;
    &quot;bm&quot;,
    &quot;Generate the bookmarks file, and open it in a new buffer.&quot;,
    function &#40;I&#41; {
        var cwd = I.local.cwd;
        yield shell&#95;command&#40;&quot;bmg; bm&quot;, $cwd = cwd&#41;;
    }&#41;;
</code></pre><p>Invoke it with:</p><pre><code>M-x bm RET
</code></pre><h2>Conclusion</h2><p>The bookmarks displayed will be sorted by time of creation, in a descending order.</p><p>There are caveats to this method, and one of them is that this is strictly a viewer. If you want to edit your bookmarks, you may copy the <code>places.sqlite</code> file to a Firefox profile, and use its built-in Bookmarks Manager to edit it. You may also edit the file directly with <a href='https://www.sqlite.org/cli.html'>sqlite3</a>, or <a href='https://github.com/sqlitebrowser/sqlitebrowser'>sqlitebrowser</a>.</p><hr/><center>  <small>Site created with <a href='https://github.com/ebzzry/emem'>emem</a>, &amp; <a href='https://gnu.org/software/emacs'>emacs</a></small><br/>  <small>Copyright Â© Rommel M. Martinez</small></center</body></html>