<!DOCTYPE html>
<html lang="eo"><head><title>Lispaj Skriptoj 1-a: Plurvokaj Plenumeblaj Dosieroj</title><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0,user-scalable=yes" name="viewport" /><meta content="noodp,noydir" name="robots" /><link rel='apple-touch-icon' sizes='180x180' href='/images/ico/apple-touch-icon.png'><link rel='icon' type='image/png' sizes='32x32' href='/images/ico/favicon-32x32.png'><link rel='icon' type='image/png' sizes='16x16' href='/images/ico/favicon-16x16.png'><link rel='manifest' href='/images/ico/site.webmanifest'><link rel='mask-icon' href='/images/ico/safari-pinned-tab.svg' color='#5bbad5'><link rel='shortcut icon' href='/images/ico/favicon.ico'> <meta name='msapplication-TileColor' content='#da532c'> <meta name='msapplication-config' content='/images/ico/browserconfig.xml'> <meta name='theme-color' content='#ffffff'><meta content="Lispaj Skriptoj 1-a" name="description" /><meta content="lispo, komuna lispo, komunlispo, skriptado, linukso" name="keywords" /><meta content="Lispaj Skriptoj 1-a: Plurvokaj Plenumeblaj Dosieroj" property="og:title" /><meta content="article" property="og:type" /><meta content="https://ebzzry.com/eo/lispaj-skriptoj-1-a/" property="og:url" /><meta content="https://ebzzry.com/images/site/lisp-lizard-1008x250.png" property="og:image" /><style media="all" type="text/css">html {    color: #333;    font-size: 1em;    font-family: Georgia, Cambria, Palatino, "Palatino Linotype", "Times New Roman", Times, serif;    line-height: 1.45;    text-align: left:    width: 100%;    max-width: 40em;    margin: 0 auto 0 auto;    padding: 0;}body {    border-top: hidden;    border-bottom: hidden;    padding: 0 1.5em 1em 1.5em;    margin: 0;}#content {    -webkit-column-count: 1;    -moz-column-count: 1;    column-count: 1;}code {    font-size: 0.9em;    font-family: "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console", "Courier New", Courier, monospace;    color: black;    display: inline-block;}pre code {    font-size: 1em;    font-family: monospace;    line-height: 1.3em;    overflow: auto;    font-weight: normal;}kbd {    font-size: 1.1em;    padding: 0.1em 0.6em;    border: 1px solid #ccc;    font-family: monospace;    background-color: #f7f7f7;    color: #333;    -moz-box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;    -webkit-box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;    box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;    -moz-border-radius: 3px;    -webkit-border-radius: 3px;    border-radius: 3px;    display: inline-block;    margin: 0 0.1em;    text-shadow: 0 1px 0 #fff;    white-space: nowrap;}h1, h2, h3, h4, h5, h6 {    font-family: Calibri, "Gill Sans", "Gill Sans MT", "Myriad Pro", Myriad, "DejaVu Sans", Tahoma, Geneva, Helvetica, Arial, sans-serif;    margin-bottom: 0;}h1 {    font-size: 2.5em;    text-align: center;    border-bottom: 6px solid black;}h2 {    font-size: 2.0em;    text-align: left;    border-bottom: 2px solid black;}h3 {    font-size: 1.6em;    text-align: left;    border-bottom: 1px solid lightgrey;}h4 {    font-size: 1.5em;    text-align: left;}h5 {    font-size: 1.3em;    text-align: left;}ul, ol {    padding-left: 2em;}ul li {    list-style-type: square;}ul li li {    list-style-type: disc;}ul li li li {    list-style-type: circle;}ol li {    list-style-type: decimal;}p, para, b, strong, i, em, emph {    font-size: 1em;}blockquote {    font-size: 1.2em;    font-style: italic;    margin-left: 2em;}b, strong {    font-weight: bold;}i, em, emph {    font-style: italic;}table {    margin: 0.5em;    border-spacing: 0;    border-collapse: collapse;}th, td {    border: 1px solid lightgray;    padding-top: 0;    padding-bottom: 0;    padding-left: 0.45em;    padding-right: 0.45em;}.text-right {    text-align: right;}.text-small {    font-size: small;}.text-x-small {    font-size: x-small;}.banner {    display: block;    width: 100%;    margin-left: auto;    margin-right: auto;}.footer {    text-align: right;    float: right;    max-width: 18em;}.cc {    border-width: 0}.center {    text-align: center;}</style><style media="all" type="text/css">/* Ewan Themes -- based 99.99% from Tomorrow Night Theme *//* http://jmblog.github.com/color-themes-for-google-code-highlightjs *//* Original theme - https://github.com/chriskempson/tomorrow-theme *//* http://jmblog.github.com/color-themes-for-google-code-highlightjs *//* Tomorrow Comment */.hljs-comment {  color: #969896;}/* Tomorrow Red */.hljs-variable,.hljs-attribute,.hljs-tag,.hljs-regexp,.ruby .hljs-constant,.xml .hljs-tag .hljs-title,.xml .hljs-pi,.xml .hljs-doctype,.html .hljs-doctype,.css .hljs-id,.css .hljs-class,.css .hljs-pseudo {  color: #cc6666;}/* Tomorrow Orange */.hljs-number,.hljs-preprocessor,.hljs-pragma,.hljs-built_in,.hljs-literal,.hljs-params,.hljs-constant {  color: #de935f;}/* Tomorrow Yellow */.ruby .hljs-class .hljs-title,.css .hljs-rule .hljs-attribute {  color: #f0c674;}/* Tomorrow Green */.hljs-string,.hljs-value,.hljs-inheritance,.hljs-header,.hljs-name,.ruby .hljs-symbol,.xml .hljs-cdata {  color: #b5bd68;}/* Tomorrow Aqua */.hljs-title,.css .hljs-hexcolor {  color: #8abeb7;}/* Tomorrow Blue */.hljs-function,.python .hljs-decorator,.python .hljs-title,.ruby .hljs-function .hljs-title,.ruby .hljs-title .hljs-keyword,.perl .hljs-sub,.javascript .hljs-title,.coffeescript .hljs-title {  color: #81a2be;}/* Tomorrow Purple */.hljs-keyword,.javascript .hljs-function {  color: #b294bb;}.hljs {  display: block;  overflow-x: auto;  background: #1d1f21;  color: #c5c8c6;  padding: 0.5em;  -webkit-text-size-adjust: none;}.coffeescript .javascript,.javascript .xml,.tex .hljs-formula,.xml .javascript,.xml .vbscript,.xml .css,.xml .hljs-cdata {  opacity: 0.5;}pre code {    font-size: 1.1em;    font-family: monospace;    line-height: 1.3em;    overflow: auto;}</style></head><body><div id="content"><h1>Lispaj Skriptoj 1-a: Plurvokaj Plenumeblaj Dosieroj</h1><p><div class="center"><a href='/en/lisp-scripting-1'>English</a> ‚äª Esperanto</div> <div class="center">2018-09-25 11:06:33 +0800</div></p><blockquote><p>La lumo kiu fajras duoble brila, fajras duone longa.<br> ‚ÄîD-ro Eldon TYRELL, Blade Runner (1982) </p></blockquote><p><img src="/images/site/chuttersnap-MpxAiNDevjU-unsplash-2000x1125.jpg" style="display: block; width: 100%; margin-left: auto; margin-right: auto;" /></p><h2><a name="et">Enhavotabelo</a></h2><ul><li><a href='#enkonduko'>Enkonduko</a></li><li><a href='#antauxkondicxoj'>Anta≈≠kondiƒâoj</a></li><li><a href='#bazaferoj'>Bazaferoj</a><ul><li><a href='#dosierindikoj'>Dosierindikoj</a></li><li><a href='#difinoj'>Difinoj</a></li><li><a href='#kunmetado'>Kunmetado</a></li></ul></li><li><a href='#pli'>Pli</a></li><li><a href='#avertoj'>Avertoj</a></li><li><a href='#finrimarkoj'>Finrimarkoj</a></li></ul><h2><a name="Enkonduko">Enkonduko</a></h2><p>Plenaj tutaj sistemoj kaj bibliotekoj estas ƒâiam komfortaj areoj por komunlispaj uzantoj. Beda≈≠rinde, de longe, ne ekzistis definitiva solvo en komunlispon uzi kiel skriptada lingvo. Skriptada lingvo, en ƒâi tiu kunteksto, signifas pri iu, kiu similas anime al komandliniaj ≈ùeloj‚Äîtio estas, iu kiu estas uzita por sistemkomandojn administri kaj regi sur la apa nivelo. La signifo anka≈≠ etendas al la a≈≠tomacioj de la rulo de taskoj kiuj aliamaniere faritaj unu post alia. En ƒâi tiu artikolo, mallongan enkondukon pri kiel komunlispon uzi en la skriptada areo mi priparolos.</p><p>Unu el la plej oftaj demandoj kiun mi ricevas kiam mi diras, ke skriptadon mi volas fari per komunlispo, estas, kiel tion mi eƒâ volas fari kaj tio maleblas. La respondo simplas: plian potencon kaj esprimplenecon mi volas havi. Maturan kaj nelimigitan lingvon mi volas havi. Lingvon kiu miajn ideojn povas esprimi en la malplej kiomo de froto mi volas havi.</p><p>Skripto estas nur tiel potenca kiel la lingvo kaj iloj povus permesi. Ba≈ùo kaj siaj amikoj, ekzemple, estas bonegaj por ideojn esprimi, tiel longe kiel komandojn oni ma≈ùinskribas ƒâe la komandlinio mem. La konduton ene skripto ƒùi imitas. Funkciojn oni povas difini por procedurojn fari, sed ili nur estas tiel. Funkcioj en Ba≈ùo ne estas ie proksimaj al la funkcioj en lingvoj kiel komunlispo. Kiel interaga uzant≈ùelo, ƒùi funkcias bone; escepte tio, ne.</p><p>Ekzistas aliaj skriptadaj solvoj en aliaj lingvoj. Haskelo, Pitono, Skimo, kaj Rubeno, kelkajn ilin nomante, ƒùin havas. Tamen estas bona eblo de komunlispo, kiu estas malfacila por realigi a≈≠ ne ekzistas en aliaj aliroj: pro la skriptoj mem estas validaj komunlispaj programoj, la programojn mi povas ≈ùargi en la REPL kaj afablajn aferojn mi povas fari kun tio. Neniu venas proksima al la flekso, kiun komunlispo provizas interagante kun realtempaj kurantaj programoj.</p><p>En ƒâi tiu mallonga gvidilo, alian belan aƒµon pri komunlispa skriptado mi anka≈≠ tu≈ùetas: multvokaj duumdosieroj. Multvoka duumdosiero estas sola rulebla dosiero kiu povas esti elreferencita per pluraj nomoj. ƒàiu nomo kongruas al specifa proceduro ene tiu sola duumdosiero. La beleco de ƒâi tiu aliro, estas, ke anstata≈≠ multajn malsamajn programojn administri, nur unu dosieron oni administras, kaj la ƒùustan proceduron ƒùi disdonos kiu uzanto deziras. ƒài tio similas al kiun Busybox faras. Komunlispe ƒâi tio estas traktita de <a href='https://github.com/fare/cl-launch'>cl-launch</a>.</p><h2><a name="antkauxkondicxoj">Anta≈≠kondiƒâoj</a></h2><p>Skriptado en komunlispo funkcias super la lingvo, tio estas, en la formo de bibliotekoj kiuj la abstraktadojn disponigas por interagi kun la sistemo kaj la medio. [Utilities for Implementation- and OS- Portability (UIOP)](https://gitlab.common-lisp.net/asdf/asdf/tree/master/uiop) estas aro de abstraktadoj kiuj nin permesas por porteblan lispan kodon skribi. UIOP estas enkonstruita en ASDF3‚Äîkiu estas parto de la plejparto de komunlispaj realigoj‚Äîdo ne ekzistas bezono por ƒùin permane instali. <a href='https://github.com/fare/inferior-shell'>inferior-shell</a> helpas por la procezojn administri. <a href='https://github.com/fare/cl-scripting'>cl-scripting</a> helpas por pli da rego.</p><p>La programo <code>cl-launch</code> devas esti instalita ƒâe la sistemo. ƒúi estos respondeca por la kreado de la multvoka duumdosiero mem. Por je <code>cl-launch</code> instali:</p><p>Per APT:</p><pre><code>$ sudo apt-get install -y cl-launch</code></pre><p>Per Nixpkgs:</p><pre><code>$ nix-env -i cl-launch</code></pre><h2><a name="bazaferoj">Bazaferoj</a></h2><h3><a name="dosierindikoj">Dosierindikoj</a></h3><p>Komencante, novan projektan dosierujon ni kreu. La projekton ni kunmetu en <code>$HOME/common-lisp</code>.</p><pre><code>$ mkdir -p &#126;/common-lisp/my-scripts</code></pre><p>ƒài tiu dosiero estas unu el la la≈≠normaj dosierindikoj kiun ASDF rampigos por <code>.asd</code>-dosieroj. Estas inde por noti, ke ne gravas se <code>$HOME/common-lisp</code> estas kutima dosierujo a≈≠ simbolligilo al iu.</p><h3><a name="difinoj">Difinoj</a></h3><p>Tiam la dosieron <code>my-scripts.asd</code> ni kreu en tiu dosierujo. Por komenci, la jenan ƒùi havos:</p><pre><code class="lisp">#-asdf3.1 &#40;error &quot;ASDF 3.1 or bust!&quot;&#41;

&#40;defsystem &quot;my-scripts&quot;
  :version &quot;0.0.1&quot;
  :description &quot;CL scripts&quot;
  :license &quot;MIT&quot;
  :author &quot;Muno VAKELO&quot;
  :class :package-inferred-system
  :depends-on &#40;&#40;:version &quot;cl-scripting&quot; &quot;0.1&quot;&#41;
               &#40;:version &quot;inferior-shell&quot; &quot;2.0.3.3&quot;&#41;
               &#40;:version &quot;fare-utils&quot; &quot;1.0.0.5&quot;&#41;
               &quot;my-scripts/main&quot;&#41;&#41;
</code></pre><p>Kelke da funkcioj kiujn ni bezonas, estas en ASDF 3.1, pro tio la tutan sistemon ni devas kondiƒâigi. La dependecojn ƒâe <code>cl-scripting</code> ni deklaras, kiu kelkajn helpilojn provizas; kaj ƒâe <code>inferior-shell</code>, kiu la aƒµojn kiujn ni bezonas por la ≈ùelajn procezojn administri provizas.</p><p>Sekve, la dosieron <code>main.lisp</code> ni kreu en la sama dosierujo. La jenan ƒùi havos:</p><pre><code class="lisp">&#40;uiop:define-package :my-scripts/main
    &#40;:use #:cl
          #:uiop
          #:cl-scripting
          #:inferior-shell
          #:fare-utils
          #:cl-launch/dispatch&#41;
  &#40;:export #:getuid
           #:symlink
           #:help
           #:main&#41;&#41;

&#40;in-package #:my-scripts/main&#41;

&#40;exporting-definitions
  &#40;defun getuid &#40;&#41;
    #+sbcl &#40;sb-posix:getuid&#41;
    #+cmu &#40;unix:unix-getuid&#41;
    #+clisp &#40;posix:uid&#41;
    #+ecl &#40;ext:getuid&#41;
    #+ccl &#40;ccl::getuid&#41;
    #+allegro &#40;excl.osi:getuid&#41;
    #-&#40;or sbcl cmu clisp ecl ccl allegro&#41; &#40;error &quot;no getuid&quot;&#41;&#41;

 &#40;defun symlink &#40;src&#41;
   &#40;let &#40;&#40;binarch &#40;resolve-absolute-location `&#40;,&#40;subpathname &#40;user-homedir-pathname&#41; &quot;bin/&quot;&#41;&#41; :ensure-directory t&#41;&#41;&#41;
     &#40;with-current-directory &#40;binarch&#41;
       &#40;dolist &#40;i &#40;cl-launch/dispatch:all-entry-names&#41;&#41;
         &#40;run `&#40;ln -sf ,src ,i&#41;&#41;&#41;&#41;&#41;
   &#40;success&#41;&#41;

 &#40;defun help &#40;&#41;
   &#40;format! t &quot;&#126;A commands: &#126;{&#126;A&#126;&#94; &#126;}&#126;%&quot; &#40;get-name&#41; &#40;all-entry-names&#41;&#41;
   &#40;success&#41;&#41;

 &#40;defun main &#40;&amp;rest args&#41;
   &#40;format t &quot;main&#126;%&quot;&#41;&#41;&#41;

&#40;register-commands :my-scripts/main&#41;
</code></pre><p>Ni komencu per je <code>UIOP:DEFINE-PACKAGE</code> uzi. Male al <code>DEFPACKAGE</code>, la necesan medion kiu estas amika al UIOP ƒâi tio kreas. En la kla≈≠zo <code>:USE</code>, la helpilojn de aliaj bibliotekoj ni uzos. En la korpo de ƒâi tiu dosiero, je <code>EXPORTING-DEFINITIONS</code> oni povas vidi. La limojn de tiuj, kiuj iƒùos duumdosieroj a≈≠ ne, ƒâi tiu markilo efektive markas. ƒúi estos uzita de <code>REGISTER-COMMANDS</code> poste.</p><p>ƒài tie, kelkajn funkciojn ni difinas: <code>SYMLINK</code> respondecas pri la kreado de la simbolligiloj por la multvoka duumdosiero; kelkajn bazuzajn informojn <code>HELP</code> montras; kaj <code>MAIN</code> estas la enirejo de nia skripto. La duumdosiero troveblos en <code>$HOME/bin/</code>. Por la procedon pri la kunmetado de la skripto kaj simbolligiloj plifaciligi, la kunmetadajn instrukciojn ni metos en Makefile. La dosieron <code>Makefile</code> en la aktuala dosierujo kreu, tiam la jenan metu:</p><pre><code class="Makefile">NAME=my-scripts
BINARY=$&#40;HOME&#41;/bin/$&#40;NAME&#41;
SCRIPT=$&#40;PWD&#41;/$&#40;NAME&#41;
CL=cl-launch

.PHONY: all $&#40;NAME&#41; clean

all: $&#40;NAME&#41;

$&#40;NAME&#41;:
    @$&#40;CL&#41; --output $&#40;NAME&#41; --dump ! --lisp sbcl --quicklisp --system $&#40;NAME&#41; --dispatch-system $&#40;NAME&#41;/main

install: $&#40;NAME&#41;
    @ln -sf $&#40;SCRIPT&#41; $&#40;BINARY&#41;
    @$&#40;SCRIPT&#41; symlink $&#40;NAME&#41;

clean:
    @rm -f $&#40;NAME&#41;
</code></pre><p>En la celo <code>$&#40;NAME&#41;</code>, je <code>cl-launch</code> ni voku kun la opcioj por la skripton kunmeti. En la celo <code>install</code>, la skripton ni alvoku kun la opcioj <code>symlink $&#40;NAME&#41;</code>, por la simbolligilojn de la multvoka duumdosiero krei. Pro nur tri funkciojn ni difinis ene la korpo de <code>EXPORTING-DEFINITIONS</code>, nur tri simbolligilojn al <code>my-scripts</code> ƒùi kreos. La eligan dosieron la opcio <code>‚Äë‚Äëoutput $&#40;NAME&#41;</code> precizigas. La <code>‚Äë‚Äëdump !</code> signifas, ke bildon ƒùi kreos, por pli rapidan startigon ≈ùalti. La opcio <code>‚Äë‚Äëlisp sbcl</code> signifas, ke je SBCL ni volas uzi, por ƒâi tiu skripto. La opcio <code>‚Äë‚Äëquicklisp</code> signifas, ke je <a href='https://www.quicklisp.org'>Quicklisp</a> ni ≈ùargas kun la bildo. La sistemon, kiun ni kreas la opcio <code>‚Äë‚Äësystem $&#40;NAME&#41;</code> ≈ùargas. La enirejo de nia programo la opcio <code>‚Äë‚Äëdispatch-system $&#40;NAME&#41;/main</code> precizigas.</p><h3><a name="kunmetado">Kunmetado</a></h3><p>Ni nun pretas por la skripton kaj la simbolligilojn krei. Por tion fari, rulu:</p><pre><code>$ mkdir -p &#126;/bin
$ make install</code></pre><p>La multvokan duumdosieron‚Äî<code>./my-scripts</code>‚Äîƒâi tiu komando kunmetas kun la respondaj simbolligiloj. La dosieruja arbo de <code>&#126;/bin</code> devas aspekti jene:</p><pre><code class="sh">$ tree &#126;/bin
/home/vakelo/bin
‚îú‚îÄ‚îÄ getuid -&gt; my-scripts
‚îú‚îÄ‚îÄ help -&gt; my-scripts
‚îú‚îÄ‚îÄ my-scripts -&gt; /home/vakelo/common-lisp/my-scripts/my-scripts
‚îî‚îÄ‚îÄ symlink -&gt; my-scripts

0 directories, 5 files
</code></pre><p>Por kontroli, ke ƒùi efektive funkcias, rulu:</p><pre><code>$ getuid</code></pre><p>Sa la uzantnumeron ƒùi montras, tiam ni povas da≈≠rigi.</p><h2><a name="pli">Pli</a></h2><p>Ni supozu, ke la baterian staton de la tekkomputilo oni volas scii de la komandlinio. Tion ni povas difini per kelkaj funkcioj. Je <code>my-scripts.asd</code> ni modifu per la aldonajn deklarojn enhavi:</p><pre><code class="lisp">#-asdf3.1 &#40;error &quot;ASDF 3.1 or bust!&quot;&#41;

&#40;defsystem &quot;my-scripts&quot;
  :version &quot;0.0.1&quot;
  :description &quot;CL scripts&quot;
  :license &quot;MIT&quot;
  :author &quot;Muno VAKELO&quot;
  :class :package-inferred-system
  :depends-on &#40;&#40;:version &quot;cl-scripting&quot; &quot;0.1&quot;&#41;
               &#40;:version &quot;inferior-shell&quot; &quot;2.0.3.3&quot;&#41;
               &#40;:version &quot;fare-utils&quot; &quot;1.0.0.5&quot;&#41;
               &quot;my-scripts/main&quot;
               &quot;my-scripts/general&quot;&#41;&#41;
</code></pre><p>Tiam, la dosieron <code>general.lisp</code> ni plenigu per la jena enhavo:</p><pre><code class="lisp">&#40;uiop:define-package #:scripts/general
    &#40;:use #:cl
          #:fare-utils
          #:uiop
          #:cl-scripting
          #:inferior-shell
          #:cl-launch/dispatch
          #:optima
          #:optima.ppcre
          #:local-time&#41;
  &#40;:export #:battery
           #:screenshot&#41;&#41;

&#40;in-package #:scripts/general&#41;

&#40;defvar &#42;screenshots-dir&#42;
  &#40;subpathname &#40;user-homedir-pathname&#41; &quot;Desktop/&quot;&#41;&#41;

&#40;defun battery-status &#40;&#41;
  &#40;let &#40;&#40;base-dir &quot;/sys/class/power&#95;supply/&#42;&quot;&#41;
        &#40;exclude-string &quot;/AC/&quot;&#41;&#41;
    &#40;with-output &#40;s nil&#41;
      &#40;loop :for dir :in &#40;remove-if #'&#40;lambda &#40;path&#41;
                                        &#40;search exclude-string &#40;native-namestring path&#41;&#41;&#41;
                                    &#40;directory&#42; base-dir&#41;&#41;
            :for battery = &#40;first &#40;last &#40;pathname-directory dir&#41;&#41;&#41;
            :for capacity = &#40;read-file-line &#40;subpathname dir &quot;capacity&quot;&#41;&#41;
            :for status = &#40;read-file-line &#40;subpathname dir &quot;status&quot;&#41;&#41;
            :do &#40;format s &quot;&#126;A: &#126;A% &#40;&#126;A&#41;&#126;%&quot; battery capacity status&#41;&#41;&#41;&#41;&#41;

&#40;exporting-definitions
 &#40;defun battery &#40;&#41;
   &#40;format t &quot;&#126;A&quot; &#40;battery-status&#41;&#41;
   &#40;values&#41;&#41;

 &#40;defun screenshot &#40;mode&#41;
   &#40;let&#42; &#40;&#40;dir &#42;screenshots-dir&#42;&#41;
          &#40;file &#40;format nil &quot;&#126;A.png&quot; &#40;format-timestring nil &#40;now&#41;&#41;&#41;&#41;
          &#40;dest &#40;format nil &quot;mv $f &#126;A&quot; dir&#41;&#41;
          &#40;image &#40;format nil &quot;&#126;A/&#126;A&quot; dir file&#41;&#41;&#41;
     &#40;flet &#40;&#40;scrot &#40;file dest &amp;rest args&#41;
              &#40;run/i `&#40;scrot ,@args ,file -e ,dest&#41;&#41;&#41;&#41;
       &#40;match mode
              &#40;&#40;ppcre &quot;&#40;full|f&#41;&quot;&#41; &#40;scrot file dest&#41;&#41;
              &#40;&#40;ppcre &quot;&#40;region|r&#41;&quot;&#41; &#40;scrot file dest '-s&#41;&#41;
              &#40;&#95; &#40;err &#40;format nil &quot;invalid mode &#126;A&#126;%&quot; mode&#41;&#41;&#41;&#41;
       &#40;run `&#40;&quot;xclip&quot; &quot;-selection&quot; &quot;clipboard&quot; &quot;-t&quot; &quot;image/png&quot; ,image&#41;&#41;
       &#40;success&#41;&#41;&#41;&#41;&#41;

&#40;register-commands :scripts/general&#41;
</code></pre><p>En la difino de <code>BATTERY</code>, la liveraƒµon de <code>&#40;BATTERY-STATUS&#41;</code> ƒùi eligas en home amika maniero, tio estas, sen la duoblaj citiloj. Tiam nenian valoron la funkcio <code>BATTERY</code> do liveras. ƒài tion ni devas fari tial, ke nur la eligon al la alvoko de <code>BATTERY-STATUS</code> ni bezonas.</p><p>Aliflanke, enrankopion per <em>scrot</em> la funkcio <code>SCREENSHOT</code> tenas tiam la absolutdosierindikon de la bildo ƒùi disponebligas el la tondeja zono per <em>xclip</em>. La bibliotekojn <code>local-time</code> por la data signovico kaj biblioteko; kaj <code>optima</code>, por la ripetiƒùa kongruado. Por la komandon <code>screenshot</code> ebligi, la duumdosierojn dependecojn instalu. La jenajn komandojn rulu ƒâe APT- kaj Nix-sistemoj, respektive:</p><pre><code>$ sudo apt-get install -y scrot xclip</code></pre><pre><code>$ nix-env -i scrot xclip</code></pre><p>Uzantapojn lanƒâi kaj administri facilas. Ni komencu per dependecon aldoni en <code>my-scripts.asd</code>:</p><pre><code class="lisp">#-asdf3.1 &#40;error &quot;ASDF 3.1 or bust!&quot;&#41;

&#40;defsystem &quot;my-scripts&quot;
  :version &quot;0.0.1&quot;
  :description &quot;CL scripts&quot;
  :license &quot;MIT&quot;
  :author &quot;Lolu VAKELO&quot;
  :class :package-inferred-system
  :depends-on &#40;&#40;:version &quot;cl-scripting&quot; &quot;0.1&quot;&#41;
               &#40;:version &quot;inferior-shell&quot; &quot;2.0.3.3&quot;&#41;
               &#40;:version &quot;fare-utils&quot; &quot;1.0.0.5&quot;&#41;
               &quot;my-scripts/main&quot;
               &quot;my-scripts/general&quot;
               &quot;my-scripts/apps&quot;&#41;&#41;
</code></pre><p>Tiam je <code>apps.lisp</code> ni plenigu:</p><pre><code class="lisp">&#40;uiop:define-package #:scripts/apps
    &#40;:use #:cl
          #:fare-utils
          #:uiop
          #:inferior-shell
          #:cl-scripting
          #:cl-launch/dispatch&#41;
  &#40;:export #:chrome
           #:kill-chrome
           #:stop-chrome
           #:continue-chrome&#41;&#41;

&#40;in-package #:scripts/apps&#41;

&#40;exporting-definitions
 &#40;defun chrome &#40;&amp;rest args&#41;
   &#40;run/i `&#40;google-chrome-beta ,@args&#41;&#41;&#41;

 &#40;defun kill-chrome &#40;&amp;rest args&#41;
   &#40;run `&#40;killall ,@args chromium-browser chromium google-chrome chrome&#41;
        :output :interactive :input :interactive :error-output nil :on-error nil&#41;
   &#40;success&#41;&#41;

 &#40;defun stop-chrome &#40;&#41;
   &#40;kill-chrome &quot;-STOP&quot;&#41;&#41;

 &#40;defun continue-chrome &#40;&#41;
   &#40;kill-chrome &quot;-CONT&quot;&#41;&#41;&#41;

&#40;register-commands :scripts/apps&#41;
</code></pre><p>Tiam je <em>my-scripts</em> ni rekunmetu:</p><pre><code class="sh">$ make install
my-scripts available commands: battery chrome continue-chrome getuid help kill-chrome main screenshot stop-chrome symlink
</code></pre><p>Hura!</p><h2><a name="avertoj">Avertoj</a></h2><p>Gravan aferon por teni en la kalkulo, estas, en la difinoj, komunlispajn ≈ùlosilvortojn oni ne povas uzi kiel la nomo de komando. Do ene <code>EXPORTING-DEFINITIONS</code> la jenan oni ne povas havi:</p><pre><code class="lisp">&#40;exporting-definitions
  &#40;defun t &#40;&amp;rest args&#41;
    &#40;run/i `&#40;urxvt ,@args&#41;`&#41;&#41;&#41;
</code></pre><p>Se tion oni faras kaj la dosieron oni provas kompili, la komunlispa realigo plendos pri nomo kiu estas jam uzata.</p><h2><a name="finrimarkoj">Finrimarkoj</a></h2><p>Onidire ke komunlispo jam velkiƒùis al obskuro; ke ƒùin oni ne plu uzas; ke ƒùi ne plu utilas. Ne, tio ne pravas. Nur ƒâar iu ne plu estas diskutita en plimulta novaƒµo, ne signifas, ke ƒùi mortas a≈≠ ƒùi ne plu plaƒâas al homo. Komunlispo estas normhava lingvo, kaj garantion programo kiu konformiƒùas al la normo havas‚Äîƒùis tia grado ke‚Äîƒùi ankora≈≠ povas kuri en la estontecon. Por lingvan normon krei estas monumenta tasko‚Äîƒùi postulas, ke malsamaj, eble konfliktaj anaroj devas akordi al unu la alia. Ekzistas multaj diversaj realigoj de komunlispo, kaj la celojn ƒâiu realigo strebas atingi, kiuj ne necesas kongruaj al la aliaj realigoj. Tio bonas tial, ke spacon ƒùi kreas por realigistoj kaj desegnistoj, pri kiel labori ƒâe la bazaj specifoj. Tiel longe kiel ili akordas al la normo, aferoj verdas.</p><p>La priresponda homo por komunlispon igi ebla kaj akceptebla estas <a href='http://fare.tunes.org'>Fran√ßois-Ren√©¬†RIDEAU</a>. Estis <a href='http://fare.livejournal.com/184127.html'>ƒâi¬†tiu¬†blogo</a> kiu min inspiris por la vivpovecon vidi de komunlispo kiel skriptada lingvo.</p><hr/><div class="footer"><p><div class="text-small"> <a href='/eo/'>Hejmo</a> ‚äª <a href='/eo/pri/'>Pri</a> ‚äª <a href='/eo/citajxoj/'>Citaƒµoj</a> ‚äª <a href='/eo/pripensoj/'>Pripensoj</a> </div></p><p><div class="text-x-small"> Kreita en üáµüá≠ per ‚ù§Ô∏è de Rommel Mart√≠nez </div></p><p></div></p></div><script src="/static/js/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>