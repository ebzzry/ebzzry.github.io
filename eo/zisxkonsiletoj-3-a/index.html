<!DOCTYPE html>
<html lang="eo"><head><title>Ziŝkonsiletoj 3-a: Ŝanĝradikighelpiloj</title><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0,user-scalable=yes" name="viewport" /><meta content="noodp,noydir" name="robots" /><meta content="Zi��konsiletoj 3-a: ��an��radikighelpiloj" name="description" /><meta content="zi��o, zisxo, zsh, konsiletoj, ��elo, sxelo, linukso, agordo, agorda��o, agorda��xo, chroot" name="keywords" /><meta content="Zi��konsiletoj 3-a: ��an��radikighelpiloj" property="og:title" /><meta content="article" property="og:type" /><meta content="https://ebzzry.io/eo/zisxkonsiletoj-3-a/" property="og:url" /><meta content="https://ebzzry.io/static/ico/android-chrome-512x512.png" property="og:image" /><link href="/static/ico/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180" /><link href="/static/ico/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" /><link href="/static/ico/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" /><link href="/static/ico/manifest.json" rel="manifest" /><link color="#5bbad5" href="/static/ico/safari-pinned-tab.svg" rel="mask-icon" /><meta content="#ffffff" name="theme-color" /><style media="all" type="text/css">html {    color: #333;    font-size: 1em;    font-family: Georgia, Cambria, Palatino, "Palatino Linotype", "Times New Roman", Times, serif;    line-height: 1.45;    text-align: left:    width: 100%;    max-width: 40em;    margin: 0 auto 0 auto;    padding: 0;}body {    border-top: hidden;    border-bottom: hidden;    padding: 0 1.5em 1em 1.5em;    margin: 0;}#content {    -webkit-column-count: 1;    -moz-column-count: 1;    column-count: 1;}code {    font-size: 0.9em;    font-family: "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console", "Courier New", Courier, monospace;    color: black;    display: inline-block;    font-weight: bold;}pre code {    font-size: 1em;    font-family: monospace;    line-height: 1.3em;    overflow: auto;    font-weight: normal;}kbd {    font-size: 1.1em;    padding: 0.1em 0.6em;    border: 1px solid #ccc;    font-family: monospace;    background-color: #f7f7f7;    color: #333;    -moz-box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;    -webkit-box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;    box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;    -moz-border-radius: 3px;    -webkit-border-radius: 3px;    border-radius: 3px;    display: inline-block;    margin: 0 0.1em;    text-shadow: 0 1px 0 #fff;    white-space: nowrap;}h1, h2, h3, h4, h5, h6 {    font-family: Calibri, "Gill Sans", "Gill Sans MT", "Myriad Pro", Myriad, "DejaVu Sans", Tahoma, Geneva, Helvetica, Arial, sans-serif;    margin-bottom: 0;}h1 {    font-size: 2.5em;    text-align: center;    border-bottom: 6px solid black;}h2 {    font-size: 2.0em;    text-align: left;    border-bottom: 2px solid black;}h3 {    font-size: 1.6em;    text-align: left;    border-bottom: 1px solid lightgrey;}h4 {    font-size: 1.5em;    text-align: left;}h5 {    font-size: 1.3em;    text-align: left;}ul, ol {    padding-left: 2em;}ul li {    list-style-type: square;}ul li li {    list-style-type: disc;}ul li li li {    list-style-type: circle;}ol li {    list-style-type: decimal;}p, para, b, strong, i, em, emph {    font-size: 1em;}blockquote {    font-size: 1.2em;    font-style: italic;    margin-left: 2em;}b, strong {    font-weight: bold;}i, em, emph {    font-style: italic;}table {    margin: 0.5em;    border-spacing: 0;    border-collapse: collapse;}th, td {    border: 1px solid lightgray;    padding-top: 0;    padding-bottom: 0;    padding-left: 0.45em;    padding-right: 0.45em;}.text-right {    text-align: right;}.text-small {    font-size: small;}.text-x-small {    font-size: x-small;}.banner {    display: block;    width: 100%;    margin-left: auto;    margin-right: auto;}.footer {    text-align: right;    float: right;    max-width: 18em;}.cc {    border-width: 0}.center {    text-align: center;}</style><style media="all" type="text/css">/* Ewan Themes -- based 99.99% from Tomorrow Night Theme *//* http://jmblog.github.com/color-themes-for-google-code-highlightjs *//* Original theme - https://github.com/chriskempson/tomorrow-theme *//* http://jmblog.github.com/color-themes-for-google-code-highlightjs *//* Tomorrow Comment */.hljs-comment {  color: #969896;}/* Tomorrow Red */.hljs-variable,.hljs-attribute,.hljs-tag,.hljs-regexp,.ruby .hljs-constant,.xml .hljs-tag .hljs-title,.xml .hljs-pi,.xml .hljs-doctype,.html .hljs-doctype,.css .hljs-id,.css .hljs-class,.css .hljs-pseudo {  color: #cc6666;}/* Tomorrow Orange */.hljs-number,.hljs-preprocessor,.hljs-pragma,.hljs-built_in,.hljs-literal,.hljs-params,.hljs-constant {  color: #de935f;}/* Tomorrow Yellow */.ruby .hljs-class .hljs-title,.css .hljs-rule .hljs-attribute {  color: #f0c674;}/* Tomorrow Green */.hljs-string,.hljs-value,.hljs-inheritance,.hljs-header,.hljs-name,.ruby .hljs-symbol,.xml .hljs-cdata {  color: #b5bd68;}/* Tomorrow Aqua */.hljs-title,.css .hljs-hexcolor {  color: #8abeb7;}/* Tomorrow Blue */.hljs-function,.python .hljs-decorator,.python .hljs-title,.ruby .hljs-function .hljs-title,.ruby .hljs-title .hljs-keyword,.perl .hljs-sub,.javascript .hljs-title,.coffeescript .hljs-title {  color: #81a2be;}/* Tomorrow Purple */.hljs-keyword,.javascript .hljs-function {  color: #b294bb;}.hljs {  display: block;  overflow-x: auto;  background: #1d1f21;  color: #c5c8c6;  padding: 0.5em;  -webkit-text-size-adjust: none;}.coffeescript .javascript,.javascript .xml,.tex .hljs-formula,.xml .javascript,.xml .vbscript,.xml .css,.xml .hljs-cdata {  opacity: 0.5;}pre code {    font-size: 1.1em;    font-family: monospace;    line-height: 1.3em;    overflow: auto;}</style></head><body><div id="content"><h1>Ziŝkonsiletoj 3-a: Ŝanĝradikighelpiloj</h1><p><div class="center"><a href='#'>Esperanto</a> · <a href='/en/zsh-tips-3'>English</a></div> <div class="center">la 26-an de septembro 2018</div> <div class="center">Laste ĝisdatigita: la 27-an de septembro 2018</div></p><blockquote><p>Ni ridas pri tio, kion ni ne povas toleri por alfronti.<br> ―Aristotelo </p></blockquote><p>Teĥnologioj kiel Docker, QEMU, kaj VirtualBox estas bonegaj iloj kiam procezojn oni volas kurigi aparte de la gastiga sistemo. Tute izolitajn mediojn ĉi tiuj teĥnikoj provizas al ni kiuj la reprodukteblecon de kodo plifaciligas testi. Tamen, estas okazoj en kiu ĉi tiuj solvoj tro pezas, kaj ion malplipezan ni bezonas. Eniras ŝanĝradikigado. Male al siaj pliplezaj amikoj, ŝanĝradikigado sidas ie proksima al la dosiersistemo, kie la risurcojn de la medio kiun ĝin alvokas ĝi povas facile aliri.</p><p>En ĉi tiu artikolo, mi parolos kiel ŝanĝradikigmedion agordi sur linukso per ziŝo. Teĥnike, ĉi tio estas kunmeto de diskutoj pri ŝelo kaj sistemadministrado, sed pro kapablojn kiuj estas ekskluzivaj al ziŝo mi uzas—aŭ alie malfacila por fari en aliaj ŝeloj—tiun paĝtitolon mi uzis.</p><h2><a name="et"></a>Enhavotabelo</h2><ul><li><a href='#superrigardo'>Superrigardo</a></li><li><a href='#antauxkondicxoj'>Antaŭkondiĉoj</a></li><li><a href='#instalo'>Instalo</a></li><li><a href='#agordo'>Agordo</a></li><li><a href='#komandoj'>La komandojn difini</a></li><li><a href='#elprovado'>Elprovado</a></li><li><a href='#finrimarkoj'>Finrimarkoj</a></li></ul><h2><a name="superrigardo"></a>Superrigardo</h2><p>Kelkfoje komandojn de aliaj sistemoj mi bezonas rapide kurigi, ekzemple, de Ubunto, por ke mian programaron mi povu testi, kun daŭra konservaj mekanismoj kaj aliro al sistemduumdosieroj. Aliaj opcioj estas laborintensivaj kaj la taskojn mi povas kuri rapide, kaj nun.</p><h2><a name="antauxkondicxoj"></a>Antaŭkondiĉoj</h2><p>Por la efektivan disan medion krei, manieron por ĝin elŝuti kaj instali sur nia disko ni bezonas. Por tion fari, je bootstrap ni bezonas.</p><p>Per Nixpkgs:</p><pre><code>% nix-env -i debootstrap</code></pre><p>Per APT:</p><pre><code>% sudo apt-get install -y debootstrap</code></pre><p>Por la aferojn fluigi, la saman uzantnomon kaj uzantnumeron de la gasgita sistemo ni uzos:</p><pre><code>% id -un; id -u</code></pre><h2><a name="instalo"></a>Instalo</h2><p>Unue la celan dosierujon ni kreu:</p><pre><code>% sudo mkdir -p /home/chrt/ubuntu</code></pre><p>Sekve, ni diru al debootstrap, ke specifan ubuntan distribuon ĝi devas instali:</p><pre><code>% sudo debootstrap xenial /home/chrt/ubuntu http://archive.ubuntu.com/ubuntu</code></pre><p>Kiam ĝi finis kuri, la bindsurmetojn de la sistemo al la cela sistemo ni devas krei:</p><pre><code>% sudo mount --bind /proc /home/chrt/ubuntu/proc
% sudo mount --bind /sys /home/chrt/ubuntu/sys
% sudo mount --bind /tmp /home/chrt/ubuntu/tmp
% sudo mount --bind /home /home/chrt/ubuntu/home
% sudo mount --bind /dev /home/chrt/ubuntu/dev
% sudo mount --bind /dev/pts /home/chrt/ubuntu/dev/pts</code></pre><h2><a name="agordo"></a>Agordo</h2><p>Por ke la ŝanĝradikigmedio funkcias ĝuste, enen ni devas iri kaj ŝanĝojn fari:</p><pre><code>% sudo chroot /home/chrt/ubuntu</code></pre><p>En ĉi tiu punkto, oni estas ensalutita kiel la ĉefuzanto per Baŝo. Kelkajn ilojn ni instalu:</p><pre><code># apt-get install -y zsh sudo</code></pre><p>Tiam la ŝanĝradikigmedian specifan konton ni kreu. Ĝin ni devas akordigi al la tiu, kiun oni nune uzas. Ni supozu, ke la aktuala uzantnomo estas <code>vakelo</code> kun la uzantnumero <code>1000</code>.</p><pre><code># useradd -u 1000 -m vakelo
# passwd vakelo</code></pre><p>Tiam, la uzanton <code>vakelo</code> ni aligu parto de la <code>sudo</code> grupo:</p><pre><code># usermod -aG sudo vakelo</code></pre><p>Tiam, ni diru al <em>sudo</em>, ke nin ĝi ne devas invitigi por la pasvorto. Por tion fari, je <code>visudo</code> ni devas uzi:</p><pre><code># visudo</code></pre><p><em>Visudo</em> estas agrabla kovrilo por la sudo-agorddosieron redakti tial, ke okaze erarojn ni faris, nin ĝi informos pri tio, kaj ne pluigas kun la ŝanĝoj, invitante al ni por ĝin ripari.  Por nia kazo, ni devas instrui al <em>sudo</em>, ke la inviton por la pasvorto ni ne bezonas. La jenan linion ŝanĝu:</p><pre><code>%sudo   ALL=&#40;ALL:ALL&#41; ALL</code></pre><p>al</p><pre><code>%sudo   ALL=&#40;ALL:ALL&#41; NOPASSWD: ALL</code></pre><p>La redaktilon fermu. Post tio, ankaŭ eliru de la ŝanĝradikigmedio:</p><pre><code># exit</code></pre><h2><a name="komandoj"></a>La komandojn difini</h2><p>De nun ni estas reen sur la gastiga maŝino. La komandojn kiuj estas efektive uzitaj por interagi al la ŝanĝradikigmedio ni devas difini. La dosieron <code>&#126;/.zshenv</code> ni malfermu per la redaktilo, tiam la jenan metu:</p><pre><code class="bash">CHROOT=/home/chrt/ubuntu

function crmount &#40;&#41; {
  for i &#40;proc sys tmp home dev&#41; {
    if &#91;&#91; ! -d $1/$i &#93;&#93;; then
      mkdir -p $1/$i
    fi

    sudo mount --bind /$i $1/$i
  }

  sudo mount --bind /dev/pts $1/dev/pts
}

function crumount &#40;&#41; {
  for i &#40;proc sys tmp home dev&#41; {
    sudo umount -fl $1/$i
  }
}

function crm &#40;&#41; {
  crmount $1
}

function cru &#40;&#41; {
  crumount $CHROOT 2&gt; /dev/null
}

function crch &#40;&#41; {
  sudo chroot $@
}

function crr &#40;&#41; {
  if ! mount | grep -q $1; then
    crm $1
  fi

  crch $1 ${argv&#91;2,-1&#93;}
}

function crs &#40;&#41; {
  crr $1 /usr/bin/sudo -i -u $USER ${argv&#91;2,-1&#93;}
}

function cre &#40;&#41; {
  if &#91;&#91; -e $CHROOT &#93;&#93;; then
      crs $CHROOT $@
  fi
}

function cr &#40;&#41; {
  if &#40;&#40; ! $#@ &#41;&#41;; then
      cr ${${SHELL:t}:-sh}
  else
    cre zsh -c &quot;cd \&quot;$PWD\&quot;; exec $&#42;&quot;
  fi
}
</code></pre><p>La ŝanĝojn konservu, tiam la redaktilon fermu. Post tio, novan ŝelon kurigu por ke la novaj komandoj estu legitaj de la startiga dosiero.</p><h2><a name="elprovado"></a>Elprovado</h2><p>La daton el la ŝanĝradikigmedio ni akiru:</p><pre><code>% cr date</code></pre><p>La daton de la uname-komando ni ankaŭ vidu:</p><pre><code>% cr uname -a</code></pre><p>Je <code>cr</code> oni ankaŭ povas kurigi por eniri al ŝelo:</p><pre><code>% cr</code></pre><p>Ene ĉi tiu ŝelo, aliron al la ekstermedio la aktuala medio havas, inkluzive la hejmdosierujon. Onin ĉi tio permesas por apojn instali kiu la datumon en la gastiga maŝina medio povas aliri.</p><p>Se la ŝanĝradikigmedion oni volas malŝalti eksplicite, kurigu:</p><pre><code>% cru</code></pre><h2><a name="finrimarkoj"></a>Finrimarkoj</h2><p>Medion havante por programojn testi kaj programojn kurigi kiuj estas ekskluzivaj al tiu platformo, en malpli peza medio, certe estas helpema aldono.</p><hr/><div class="footer"><p><div class="text-small"> <a href='/eo'>Hejmo</a> · <a href='/eo/pri'>Pri</a> · <a href='/eo/citajxoj'>Citaĵoj</a> · <a href='/eo/pripensoj'>Pripensoj</a> · <a href='https://github.com/ebzzry/ebzzry.github.io'>Fonto</a> </div> <div class="text-x-small"> Kreitis per <a href='https://github.com/ebzzry/emem'>emem</a> </div></p><p><div class="text-x-small"> <a rel="license" href="https://creativecommons.org/publicdomain/zero/1.0/deed.eo"><img alt="CC0 1.0 Universala (CC0 1.0) Publikaĵiga Dediĉo" class="cc" src="/bil/cc0-88x31.png" /></a><br> Ĉi tiu verko estas <a rel="license" href="https://creativecommons.org/publicdomain/zero/1.0/deed.eo">publika havaĵo.</a><br> </div></p><p></div></p></div><script src="/static/js/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-93746003-1', 'auto');ga('send', 'pageview');</script></body></html>